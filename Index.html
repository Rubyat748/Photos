<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZTA</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  body{background:#000;color:#fff;font-family:Arial,sans-serif;min-height:100vh}
  header{text-align:center;padding:3rem 1rem;border-bottom:4px solid #fff}
  h1{font-size:4.5rem;letter-spacing:12px;text-transform:uppercase;font-weight:900}
  .tag{font-size:1.1rem;opacity:0.8;margin-top:10px;letter-spacing:4px}
  .container{max-width:1200px;margin:0 auto;padding:20px}
  .upload{background:#111;border:3px dashed #555;border-radius:16px;padding:60px;text-align:center;margin:40px 0;cursor:pointer;transition:0.4s}
  .upload:hover{border-color:#fff;background:#1a1a1a}
  .upload h3{font-size:2rem;margin:15px 0}
  .status{text-align:center;margin:20px;font-size:1.2rem;color:#0f0;min-height:30px}
  .gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:30px;margin-top:30px}
  .card{background:#111;border-radius:16px;overflow:hidden;box-shadow:0 10px 40px rgba(0,0,0,0.8);transition:0.4s}
  .card:hover{transform:translateY(-16px)}
  .card img,.card video{width:100%;height:280px;object-fit:cover;background:#000}
  .info{padding:20px;text-align:center}
  .info p{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-bottom:12px}
  .dl{background:#fff;color:#000;border:none;padding:12px;width:88%;border-radius:30px;font-weight:bold;cursor:pointer}
  .dl:hover{background:#ccc}
  .empty{grid-column:1/-1;text-align:center;padding:120px;font-size:1.8rem;opacity:0.6}
</style>
</head>
<body>

<header>
  <h1>ZTA</h1>
  <p class="tag">UPLOAD ONCE – VISIBLE EVERYWHERE</p>
</header>

<div class="container">
  <div class="upload" id="drop">
    <h3>Click or Drop Files Here</h3>
    <p>Photos & Videos – instantly shared</p>
    <input type="file" id="files" multiple accept="image/*,video/*" style="display:none">
  </div>

  <div class="status" id="status"></div>

  <div class="gallery" id="gallery">
    <div class="empty">Loading...</div>
  </div>
</div>

<script>
// This free service gives you permanent direct links in 1 second
const UPLOAD_API = "https://tmpfiles.org/api/v1/upload";

let sharedFiles = [];

// Click or drop → open file picker
document.getElementById("drop").onclick = () => document.getElementById("files").click();

// Drag & drop
["dragover","dragenter"].forEach(e=>document.getElementById("drop").addEventListener(e,ev=>ev.preventDefault()));
document.getElementById("drop").ondrop = e => { e.preventDefault(); handle(e.dataTransfer.files); };

// File selected
document.getElementById("files").onchange = e => handle(e.target.files);

async function handle(list) {
  if (!list.length) return;
  const status = document.getElementById("status");
  status.textContent = "Uploading...";

  for (let file of list) {
    if (!file.type.match(/image|video/)) continue;

    const form = new FormData();
    form.append("file", file);

    try {
      const res = await fetch(UPLOAD_API, { method: "POST", body: form });
      const json = await res.json();
      const url = json.data.url.replace("https://tmpfiles.org/", "https://tmpfiles.org/dl/"); // direct link

      const entry = { name: file.name, url, type: file.type };
      sharedFiles.unshift(entry);
      addCard(entry);
      status.textContent = `Uploaded: ${file.name}`;
    } catch (err) {
      status.textContent = "Upload failed – try again";
      console.error(err);
    }
  }
}

function addCard(f) {
  if (document.querySelector('.empty')) document.querySelector('.empty').remove();

  const card = document.createElement("div");
  card.className = "card";
  const media = f.type.includes("video")
    ? `<video controls><source src="${f.url}"></video>`
    : `<img src="${f.url}" loading="lazy">`;
  const short = f.name.length > 30 ? f.name.slice(0,27)+"..." : f.name;

  card.innerHTML = `
    ${media}
    <div class="info">
      <p title="${f.name}">${short}</p>
      <button class="dl" onclick="window.location.href='${f.url}'">Download</button>
    </div>
  `;
  document.getElementById("gallery").prepend(card);
}

// Load what others have uploaded (same for everyone)
async function loadAll() {
  // This file contains everyone's uploads (public)
  const listUrl = "https://raw.githubusercontent.com/ztashare/media/main/zta.json";
  try {
    const res = await fetch(listUrl + "?t=" + Date.now());
    const data = await res.json();
    sharedFiles = data;
    document.getElementById("gallery").innerHTML = "";
    if (data.length === 0) throw 0;
    data.forEach(addCard);
    document.getElementById("status").textContent = `Loaded ${data.length} files`;
  } catch {
    document.getElementById("gallery").innerHTML = '<div class="empty">No files yet – upload the first one!</div>';
  }
}

// Start
loadAll();
</script>
</body>
</html>
